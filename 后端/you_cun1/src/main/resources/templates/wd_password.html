<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>输入文档密码 - 优存科技</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dracula: {
                            bg: '#282a36',       // 背景色
                            surface: '#44475a',  // 表面色
                            primary: '#bd93f9',  // 主色调(紫色)
                            secondary: '#8be9fd',// 辅助色(青色)
                            accent: '#ff79c6',   // 强调色(粉色)
                            success: '#50fa7b',  // 成功色(绿色)
                            danger: '#ff5555',   // 危险色(红色)
                            text: '#f8f8f2',     // 文本色
                            comment: '#6272a4'   // 注释色
                        }
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>

    <style type="text/tailwindcss">
        @layer utilities {
            /* 毛玻璃效果 */
            .glass {
                background: rgba(68, 71, 90, 0.7);
                backdrop-filter: blur(12px);
                -webkit-backdrop-filter: blur(12px);
                border: 1px solid rgba(189, 147, 249, 0.2);
            }
            /* 悬浮动画 */
            .float {
                animation: float 6s ease-in-out infinite;
            }
            @keyframes float {
                0% { transform: translateY(0px); }
                50% { transform: translateY(-10px); }
                100% { transform: translateY(0px); }
            }
            /* 输入框焦点效果 */
            .input-focus {
                @apply focus:ring-2 focus:ring-dracula-primary/50 focus:border-dracula-primary focus:outline-none;
            }
            /* 按钮悬停效果 */
            .btn-hover {
                @apply hover:shadow-lg hover:shadow-dracula-primary/20 transform hover:-translate-y-1 active:translate-y-0 transition-all duration-300;
            }
        }
    </style>
</head>

<body class="bg-dracula-bg min-h-screen flex items-center justify-center p-4 font-inter text-dracula-text overflow-hidden">

<div class="fixed inset-0 -z-10 overflow-hidden">
    <div class="absolute top-1/4 left-1/4 w-72 h-72 bg-dracula-primary/20 rounded-full blur-3xl float"></div>
    <div class="absolute bottom-1/3 right-1/4 w-80 h-80 bg-dracula-secondary/20 rounded-full blur-3xl float" style="animation-delay: 2s;"></div>
    <div class="absolute top-1/2 right-1/3 w-64 h-64 bg-dracula-accent/20 rounded-full blur-3xl float" style="animation-delay: 4s;"></div>
</div>

<div class="glass rounded-2xl w-full max-w-md overflow-hidden transition-all duration-500 hover:shadow-[0_0_30px_rgba(189,147,249,0.15)]">
    <div class="p-8">
        <div class="text-center mb-8">
            <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-dracula-primary/20 mb-4">
                <i class="fa fa-file-text-o text-2xl text-dracula-primary"></i>
            </div>
            <h1 class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-dracula-text">文档加密保护</h1>
            <p class="text-dracula-comment mt-2">该文档已加密，请输入密码访问</p>
        </div>

        <div id="errorMsg" class="hidden bg-dracula-danger/20 border border-dracula-danger/30 text-dracula-danger p-3 rounded-lg mb-4 transition-all duration-300 transform translate-y-0 opacity-0">
            <i class="fa fa-exclamation-circle mr-2"></i><span id="errorText"></span>
        </div>
        <form id="passwordForm" action="/api/user/getFile" method="get" class="space-y-6">
            <input type="hidden" id="Ftoken" name="Ftoken" required>
            <input type="hidden" id="type" name="type" required>


            <div class="space-y-2">
                <label for="Fpassword" class="block text-dracula-text font-medium flex items-center">
                    <i class="fa fa-lock text-dracula-secondary mr-2"></i>文档密码
                </label>
                <div class="relative">
                    <input type="password" id="Fpassword" name="Fpassword"
                           class="w-full px-4 py-3 bg-dracula-surface/50 border border-dracula-primary/30 rounded-lg text-dracula-text input-focus transition-all duration-300"
                           placeholder="请输入文档密码" required>
                    <button type="button" id="togglePassword" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-dracula-comment hover:text-dracula-text transition-colors">
                        <i class="fa fa-eye-slash"></i>
                    </button>
                </div>
            </div>

            <button type="submit"
                    class="w-full bg-gradient-to-r from-dracula-primary to-dracula-accent text-dracula-text font-medium py-3 px-4 rounded-lg btn-hover flex items-center justify-center">
                <span>确认访问</span>
                <i class="fa fa-arrow-right ml-2"></i>
            </button>
        </form>

        <div class="mt-6 text-center">
            <p class="text-dracula-comment text-sm">
                @优存科技 版权所有
            </p>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const urlParams = new URLSearchParams(window.location.search);
        const ftoken = urlParams.get('Ftoken');
        const ftokenInput = document.getElementById('Ftoken');
        const type = urlParams.get('type');
        const typeInput = document.getElementById('type');
        const submitBtn = document.querySelector('button[type="submit"]');


        if (!ftoken) {
            showError('文档信息缺失，请重新获取文档链接');
            submitBtn.disabled = true;
            submitBtn.classList.add('opacity-50', 'cursor-not-allowed');
            return;
        }

        ftokenInput.value = ftoken;
        typeInput.value = type;


        const toggleBtn = document.getElementById('togglePassword');
        const passwordInput = document.getElementById('Fpassword');

        toggleBtn.addEventListener('click', function() {
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);

            const icon = toggleBtn.querySelector('i');
            if (type === 'password') {
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        });
    });

    document.getElementById('passwordForm').addEventListener('submit', function(e) {
        const password = document.getElementById('Fpassword').value;

        if (!password || password.trim() === '') {
            e.preventDefault();
            showError('请输入文档密码');
            return;
        }
    });

    function showError(message) {
        const errorMsg = document.getElementById('errorMsg');
        const errorText = document.getElementById('errorText');

        errorText.textContent = message;
        errorMsg.classList.remove('hidden');

        setTimeout(() => {
            errorMsg.classList.remove('translate-y-0', 'opacity-0');
            errorMsg.classList.add('translate-y-2', 'opacity-100');
        }, 10);

        setTimeout(() => {
            errorMsg.classList.remove('translate-y-2', 'opacity-100');
            errorMsg.classList.add('translate-y-0', 'opacity-0');

            setTimeout(() => {
                errorMsg.classList.add('hidden');
            }, 300);
        }, 3000);
    }
</script>
</body>
</html>
